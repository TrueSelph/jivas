import{w as u,v as d,z as x}from"./chunk-QMGIS6GS-CBZUm-7V.js";import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{U as w}from"./UserButton-C7P-xVhi.js";import{f as m}from"./api-tgDzxHzW.js";import{B as g}from"./polymorphic-factory-EW0USS3V.js";import{G as f}from"./Group-bnACpcuK.js";import{A as v}from"./ActionIcon-BO4DDcDR.js";import{I as y}from"./IconArrowLeft-4qKQ7vAI.js";import{T as S}from"./Title-B0fFn55O.js";import{D as b}from"./Divider-BI4N1hoX.js";import{C as I}from"./Card-BHrMkZ_V.js";import"./Avatar-BMARKXxx.js";import"./Input-I-MjqIR2.js";import"./CloseButton-BDZlzHA2.js";import"./Loader-1VreoqJz.js";import"./index-B4z8r-Ct.js";import"./events-BOd7YSSb.js";import"./Text-CkpJSrnl.js";import"./Stack-BsPYYAFq.js";import"./Button-BhC08Y9X.js";import"./createReactComponent-CwEnMXT7.js";import"./Paper-k397c_lM.js";import"./create-safe-context-CzEsa9t0.js";function H(){return[{title:"Actions | JIVAS Manager"}]}async function K({request:j}){var p,c,l,h;const n=localStorage.getItem("jivas-host"),s=localStorage.getItem("jivas-agent"),o=s?await m(`${n}/walker/get_agent`,{method:"POST",body:JSON.stringify({agent_id:s}),headers:{"Content-Type":"application/json"}}).then(r=>{if(r.ok)return r.json();throw localStorage.removeItem("jivas-agent"),d("/login")}).catch(r=>{throw console.log({err:r}),localStorage.removeItem("jivas-agent"),d("/login")}):null,a=new FormData;a.append("args",'{"base64_prefix": false}'),a.append("module_root","actions.jivas.avatar_action"),a.append("agent_id",((c=(p=o==null?void 0:o.reports)==null?void 0:p[0])==null?void 0:c.id)||""),a.append("walker","get_avatar");const e=await m(`${n}/action/walker`,{method:"POST",body:a}).then(async r=>await r.json()).catch(()=>null),i=await m(`${n}/walker/list_agents`,{method:"POST",body:JSON.stringify({}),headers:{"Content-Type":"application/json"}}).then(r=>r.json()).catch(()=>({reports:[]}));return{selectedAgentInfo:{...((l=o==null?void 0:o.reports)==null?void 0:l[0])||{},thumbnail:!((h=e==null?void 0:e.includes)!=null&&h.call(e,"unable"))&&e&&typeof e=="string"?`data:image/png;base64,${e}`:""},agents:i==null?void 0:i.reports}}const Q=u(function({loaderData:n}){const s=localStorage.getItem("jivas-host"),o=localStorage.getItem("jivas-root-id");return t.jsxs(g,{px:"xl",children:[t.jsxs(f,{justify:"space-between",children:[t.jsxs(f,{children:[t.jsx(v,{color:"dark",size:"sm",component:x,to:"/dashboard",children:t.jsx(y,{})}),t.jsx(S,{order:3,children:"Graph"})]}),t.jsx(g,{children:t.jsx(w,{selectedAgentInfo:n.selectedAgentInfo||null,agents:n.agents})})]}),t.jsx(b,{mt:"xs",mb:"sm"}),t.jsx(I,{px:"0",py:"0",h:"86vh",withBorder:!0,pos:"relative",children:t.jsx("jvgraph-viewer",{className:"min-h-[740px]",host:s,root_node:o,style:{width:"100%",height:"100%",border:"none",outline:"none"}},n.selectedAgentInfo.id)})]})});export{K as clientLoader,Q as default,H as meta};
